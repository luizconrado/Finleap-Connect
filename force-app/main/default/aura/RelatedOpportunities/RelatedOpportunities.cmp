<aura:component implements="flexipage:availableForRecordHome,force:hasRecordId,force:hasSObjectName" Controller="RelatedOpportunityController"  access="global" >
    <aura:handler name="init" value="{!this}" action="{!c.doInit}" />
    <lightning:navigation aura:id="navService"/>


    <aura:handler name="RelatedList_viewAll" event="c:RelatedListEvent" action="{!c.viewAllInvoked}"/>
    <aura:handler name="RelatedList_openRecord" event="c:RelatedListEvent" action="{!c.openRecordInvoked}"/>

    <!--data attribute-->
    <aura:attribute name="opportunityList"  type="List" />
    <aura:attribute name="opportunityFieldsList" type="List" />
    <aura:attribute name="viewListData" type="List" />
    <aura:attribute name="viewAllListData" type="List" />

    <!--load attributs-->
    <aura:attribute name="isMobile" type="boolean" default="false" access="private"/>
    <aura:attribute name="loadView" type="boolean" default="false" />    
    <aura:attribute name="isViewAll" type="boolean" default="false" />
    <aura:attribute name="isViewRecord" type="boolean" default="false" />
    
    
    <aura:attribute name="viewHeader" type="string" />    
    <aura:attribute name="viewRecord" type="object"/>
        
    <!--popups-->
    <aura:if isTrue="{!v.isViewAll}">
        <c:Modal header="{!'All Opportunities ('+v.viewAllListData.length+')'}" open="{!v.isViewAll}" >
            <c:RelatedListItem recordList="{!v.viewAllListData}" tileclass="slds-box" viewLength="{!v.viewAllListData.length}"></c:RelatedListItem>
        </c:Modal>
    </aura:if>
    <aura:if isTrue="{!v.isViewRecord}">
        <c:Modal header="{!v.viewHeader}" isLarge="true" open="{!v.isViewRecord}" >
            <c:FormLayout header="Opportunity Details" fieldsList="{!v.opportunityFieldsList}" record="{!v.viewRecord}" />
            <div class="slds-notify_container slds-is-relative">
                <div class="info-title slds-notify slds-notify_toast slds-theme_alert-texture slds-theme_warning" role="status">
                    {!$Label.c.Insufficient_Access_Text}
                </div>
            </div>
        </c:Modal>
    </aura:if>
    
    <!--list-->
    <aura:if isTrue="{!v.loadView}">
        <c:RelatedList icon="standard:opportunity" header="{!'Global Opportunities ('+v.opportunityList.length+')'}" recordViewList="{!v.viewListData}">
        </c:RelatedList>
    </aura:if>

   

</aura:component>